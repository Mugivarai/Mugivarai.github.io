(function(){"use strict";var e={3620:function(e,t,s){e.exports=s.p+"assets/img/ai-logo.2d39bd89.png"},9817:function(e,t,s){var n=s(5130),o=s(2261),i=s(6768);const c={class:"widget-chat-container"},a={key:1,class:"chat-container",ref:"widgetChat"};function l(e,t,s,n,o,l){const r=(0,i.g2)("ChatHeader"),d=(0,i.g2)("ChatMessages"),h=(0,i.g2)("ChatInputMessage");return(0,i.uX)(),(0,i.CE)("div",c,[o.openWidget?((0,i.uX)(),(0,i.CE)("div",a,[(0,i.bF)(r,{onCloseWidget:l.closeWindow},null,8,["onCloseWidget"]),(0,i.bF)(d),(0,i.bF)(h)],512)):((0,i.uX)(),(0,i.CE)("div",{key:0,class:"circle-widget",onClick:t[0]||(t[0]=(...e)=>l.openWindow&&l.openWindow(...e))},t[1]||(t[1]=[(0,i.Fv)('<div class="no-circle-container anime-list"><div class="no-circle" style="--i:7;"></div><div class="no-circle" style="--i:6;"></div><div class="no-circle" style="--i:5;"></div><div class="no-circle" style="--i:4;"></div><div class="no-circle" style="--i:8;"></div><div class="no-circle" style="--i:9;"></div></div>',1)])))])}var r=s(4232);const d={class:"logo"},h=["src"],u={class:"ai-status-container"},g={class:"ai-status"},L={class:"ai-status-bg"},m={class:"setting-buttons"};function v(e,t,n,o,c,a){return(0,i.uX)(),(0,i.CE)("header",null,[(0,i.Lk)("div",d,[(0,i.Lk)("img",{src:s(3620),alt:"logo"},null,8,h),(0,i.Lk)("div",u,[t[2]||(t[2]=(0,i.Lk)("span",null,"ИИ помощник",-1)),(0,i.Lk)("div",g,[(0,i.Lk)("div",L,[(0,i.Lk)("div",{class:(0,r.C4)(["ai-status-circle ",o.chatStore.isConnected?"online":"offline"])},null,2),(0,i.Lk)("span",{class:(0,r.C4)(["ai-status-title ",o.chatStore.isConnected?"online":"offline"])},(0,r.v_)(o.chatStore.isConnected?"Online":"Offline"),3)])])])]),(0,i.Lk)("div",m,[(0,i.Lk)("button",{class:"theme-toggle",onClick:t[0]||(t[0]=(...e)=>a.toggleTheme&&a.toggleTheme(...e)),"aria-label":"Сменить тему"},t[3]||(t[3]=[(0,i.Lk)("svg",{class:"theme-icon sun",viewBox:"0 0 24 24"},[(0,i.Lk)("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0 .39-.39.39-1.03 0-1.41l-1.06-1.06zm1.06-10.96c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})],-1),(0,i.Lk)("svg",{class:"theme-icon moon",viewBox:"0 0 24 24"},[(0,i.Lk)("path",{d:"M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1-8.313-12.454z"})],-1)])),(0,i.Lk)("button",{class:"close-widget-button",onClick:t[1]||(t[1]=(...e)=>a.closeWidget&&a.closeWidget(...e))})])])}s(4114);class k{constructor(e,{onOpen:t,onClose:s}){this.url=e,this.socket=null,this.chatStore=p(),this.reconnectAttempts=0,this.maxReconnectAttempts=5,this.reconnectDelay=1e3,this.isManualClose=!1,this.onOpenCallback=t,this.onCloseCallback=s,this.connect()}connect(){this.socket=new WebSocket(this.url),this.socket.onopen=()=>{console.log("WebSocket connected"),this.reconnectAttempts=0,this.onOpenCallback&&this.onOpenCallback()},this.socket.onmessage=e=>{let t={};try{t.sender="ai",t.content=e.data,t.type="message"}catch(s){return void console.error("Error parsing WebSocket message:",s)}this.handleMessage(t)},this.socket.onclose=e=>{if(!this.isManualClose&&(console.log(`WebSocket closed. Code: ${e.code}, Reason: ${e.reason}`),this.onCloseCallback&&this.onCloseCallback(),this.reconnectAttempts<this.maxReconnectAttempts)){this.reconnectAttempts+=1;const e=this.reconnectDelay*Math.pow(2,this.reconnectAttempts-1);console.log(`Reconnecting (${this.reconnectAttempts}/${this.maxReconnectAttempts}) in ${e}ms…`),setTimeout(()=>this.connect(),e)}},this.socket.onerror=e=>{console.error("WebSocket error:",e)}}handleMessage(e){if("message"===e.type){const t=new Date,s=t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});this.chatStore.addMessage(e.content,e.sender||"ai",s)}}send(e){if(!this.socket||this.socket.readyState!==WebSocket.OPEN)return;const t="string"===typeof e?e:JSON.stringify(e);this.socket.send(t)}close(){this.isManualClose=!0,this.socket&&this.socket.close(1e3,"Closed by client")}get status(){return this.socket?this.socket.readyState:WebSocket.CLOSED}}const p=(0,o.nY)("chat",{state:()=>({scrollElement:null,socketService:null,isConnected:!1,messages:[{sendler:"ai",messages:[{text:"Привет! Как я могу вам помочь?",time:"12:30"}]},{sendler:"user",messages:[{text:"Мне нужна помощь с моим заказом",time:"12:32"}]},{sendler:"employee",messages:[{text:"Как я могу вам помочь?",time:"12:35"},{text:"Спрашивайте и не стеняйтесь",time:"12:36"}]},{sendler:"user",messages:[{text:"Сколько будет стоить мой заказ?",time:"12:37"}]}]}),actions:{async addMessage(e,t,s){if(0===this.messages.length||this.messages[this.messages.length-1].sendler!==t)return this.messages.push({sendler:t,messages:[{text:e,time:s}]}),await(0,i.dY)(),void this.scrollToBottom();let n=this.messages[this.messages.length-1];n.sendler===t&&n.messages.push({text:e,time:s}),await(0,i.dY)(),this.scrollToBottom()},setScrollElement(e){this.scrollElement=e},scrollToBottom(){this.scrollElement&&(this.scrollElement.scrollTop=this.scrollElement.scrollHeight)},initializeWebSocket(e="wss://echo.websocket.events/"){console.log(e),console.log("WS URL:","wss://echo.websocket.events/"),this.socketService=new k(e,{onOpen:()=>{this.isConnected=!0},onClose:()=>{this.isConnected=!1}})},sendWebSocketMessage(e){this.socketService&&this.socketService.send(e)},closeWebSocket(){this.socketService&&(this.socketService.close(),this.isConnected=!1)}}});var f={setup(){const e=p();return{chatStore:e}},methods:{closeWidget(){this.$emit("closeWidget")},toggleTheme(){document.body.classList.toggle("dark-theme")}}},C=s(1241);const b=(0,C.A)(f,[["render",v],["__scopeId","data-v-07bf5b00"]]);var M=b;const x={class:"main-container",ref:"mainScroll"},w={class:"message-container"},S={key:0,class:"two-column"},y={class:"icon-image"},E={key:0,class:"ai-icon"},W={key:1,class:"operator-icon"},O={class:"column-messages"},$={key:1,class:"column-messages one-column"};function T(e,t,s,n,o,c){return(0,i.uX)(),(0,i.CE)("main",x,[(0,i.Lk)("div",w,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(n.chatStore.messages,(e,s)=>((0,i.uX)(),(0,i.CE)("div",{class:"subsection",key:s},["user"!==e["sendler"]?((0,i.uX)(),(0,i.CE)("div",S,[(0,i.Lk)("div",y,["ai"===e.sendler?((0,i.uX)(),(0,i.CE)("span",E,t[0]||(t[0]=[(0,i.Lk)("svg",{viewBox:"0 0 512 512",version:"1.1"},[(0,i.Lk)("title",null,"ai"),(0,i.Lk)("g",{id:"Page-1",stroke:"none","stroke-width":"1","fill-rule":"evenodd"},[(0,i.Lk)("g",{id:"icon",transform:"translate(64.000000, 64.000000)"},[(0,i.Lk)("path",{d:"M320,64 L320,320 L64,320 L64,64 L320,64 Z M171.749388,128 L146.817842,128 L99.4840387,256 L121.976629,256 L130.913039,230.977 L187.575039,230.977 L196.319607,256 L220.167172,256 L171.749388,128 Z M260.093778,128 L237.691519,128 L237.691519,256 L260.093778,256 L260.093778,128 Z M159.094727,149.47526 L181.409039,213.333 L137.135039,213.333 L159.094727,149.47526 Z M341.333333,256 L384,256 L384,298.666667 L341.333333,298.666667 L341.333333,256 Z M85.3333333,341.333333 L128,341.333333 L128,384 L85.3333333,384 L85.3333333,341.333333 Z M170.666667,341.333333 L213.333333,341.333333 L213.333333,384 L170.666667,384 L170.666667,341.333333 Z M85.3333333,0 L128,0 L128,42.6666667 L85.3333333,42.6666667 L85.3333333,0 Z M256,341.333333 L298.666667,341.333333 L298.666667,384 L256,384 L256,341.333333 Z M170.666667,0 L213.333333,0 L213.333333,42.6666667 L170.666667,42.6666667 L170.666667,0 Z M256,0 L298.666667,0 L298.666667,42.6666667 L256,42.6666667 L256,0 Z M341.333333,170.666667 L384,170.666667 L384,213.333333 L341.333333,213.333333 L341.333333,170.666667 Z M0,256 L42.6666667,256 L42.6666667,298.666667 L0,298.666667 L0,256 Z M341.333333,85.3333333 L384,85.3333333 L384,128 L341.333333,128 L341.333333,85.3333333 Z M0,170.666667 L42.6666667,170.666667 L42.6666667,213.333333 L0,213.333333 L0,170.666667 Z M0,85.3333333 L42.6666667,85.3333333 L42.6666667,128 L0,128 L0,85.3333333 Z",id:"Combined-Shape"})])])],-1)]))):((0,i.uX)(),(0,i.CE)("span",W,t[1]||(t[1]=[(0,i.Lk)("svg",{viewBox:"0 0 32 32"},[(0,i.Lk)("path",{d:"M16 15.503A5.041 5.041 0 1 0 16 5.42a5.041 5.041 0 0 0 0 10.083zm0 2.215c-6.703 0-11 3.699-11 5.5v3.363h22v-3.363c0-2.178-4.068-5.5-11-5.5z"})],-1)])))]),(0,i.Lk)("div",O,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e["messages"],(e,t)=>((0,i.uX)(),(0,i.CE)("div",{key:t,class:"no-user-message"},[(0,i.Lk)("p",null,(0,r.v_)(e["text"]),1),(0,i.Lk)("span",null,(0,r.v_)(e["time"]),1)]))),128))])])):((0,i.uX)(),(0,i.CE)("div",$,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e["messages"],(e,t)=>((0,i.uX)(),(0,i.CE)("div",{key:t,class:"user-message"},[(0,i.Lk)("p",null,(0,r.v_)(e["text"]),1),(0,i.Lk)("span",null,(0,r.v_)(e["time"]),1)]))),128))]))]))),128))])],512)}var z={setup(){const e=p();return{chatStore:e}},mounted(){this.chatStore.setScrollElement(this.$refs.mainScroll)}};const Z=(0,C.A)(z,[["render",T],["__scopeId","data-v-2d5395c2"]]);var X=Z;const A={class:"main-container"},_={class:"input-wrapper"},I=["disabled"];function j(e,t,s,o,c,a){return(0,i.uX)(),(0,i.CE)("footer",A,[(0,i.Lk)("div",_,[(0,i.bo)((0,i.Lk)("textarea",{onInput:t[0]||(t[0]=(...e)=>a.resizeTextarea&&a.resizeTextarea(...e)),"onUpdate:modelValue":t[1]||(t[1]=e=>c.textMessage=e),ref:"textarea",rows:"1",onScroll:t[2]||(t[2]=(...e)=>a.onScroll&&a.onScroll(...e)),maxlength:"5000",onKeydown:t[3]||(t[3]=(0,n.jR)((0,n.D$)((...e)=>a.sendMessage&&a.sendMessage(...e),["prevent"]),["enter"])),placeholder:"Напишите сообщение..."},null,544),[[n.Jo,c.textMessage]]),(0,i.Lk)("button",{class:"send-button",onClick:t[4]||(t[4]=(...e)=>a.sendMessage&&a.sendMessage(...e)),disabled:!c.textMessage.trim()},t[5]||(t[5]=[(0,i.Lk)("svg",{width:"800px",height:"800px",viewBox:"0 0 24 24",fill:"none"},[(0,i.Lk)("path",{d:"M11.5003 12H5.41872M5.24634 12.7972L4.24158 15.7986C3.69128 17.4424 3.41613 18.2643 3.61359 18.7704C3.78506 19.21 4.15335 19.5432 4.6078 19.6701C5.13111 19.8161 5.92151 19.4604 7.50231 18.7491L17.6367 14.1886C19.1797 13.4942 19.9512 13.1471 20.1896 12.6648C20.3968 12.2458 20.3968 11.7541 20.1896 11.3351C19.9512 10.8529 19.1797 10.5057 17.6367 9.81135L7.48483 5.24303C5.90879 4.53382 5.12078 4.17921 4.59799 4.32468C4.14397 4.45101 3.77572 4.78336 3.60365 5.22209C3.40551 5.72728 3.67772 6.54741 4.22215 8.18767L5.24829 11.2793C5.34179 11.561 5.38855 11.7019 5.407 11.8459C5.42338 11.9738 5.42321 12.1032 5.40651 12.231C5.38768 12.375 5.34057 12.5157 5.24634 12.7972Z","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]),8,I)])])}var B={data(){return{textMessage:""}},methods:{resizeTextarea(){this.$refs.textarea.style.height="auto",this.$refs.textarea.style.height=this.$refs.textarea.scrollHeight+"px"},onScroll(){const e=this.$refs.textarea;e.classList.toggle("has-shadow",e.scrollTop>0)},sendMessage(){if(this.textMessage.trim()){let e=new Date,t=`${e.getHours()}:${e.getMinutes()}`;p().addMessage(this.textMessage.trim(),"user",t),p().sendWebSocketMessage(this.textMessage.trim()),this.textMessage="",this.$refs.textarea.style.height="40px",this.$nextTick(()=>{this.$refs.textarea.focus()})}}}};const F=(0,C.A)(B,[["render",j],["__scopeId","data-v-ffc95d58"]]);var H=F,R={components:{ChatHeader:M,ChatMessages:X,ChatInputMessage:H},data(){return{openWidget:!1}},mounted(){p().initializeWebSocket()},unmounted(){p().closeWebSocket()},methods:{openWindow(){this.openWidget=!0,this.$nextTick(()=>{const e=this.$refs.widgetChat;e.classList.add("active")})},closeWindow(){const e=this.$refs.widgetChat;e.classList.remove("active"),e.classList.add("noactive"),setTimeout(()=>{this.openWidget=!1,e.classList.remove("noactive")},400)}}};const D=(0,C.A)(R,[["render",l]]);var K=D;const P=(0,n.Ef)(K),Y=(0,o.Ey)();P.use(Y),P.mount("#app")}},t={};function s(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,s),i.exports}s.m=e,function(){var e=[];s.O=function(t,n,o,i){if(!n){var c=1/0;for(d=0;d<e.length;d++){n=e[d][0],o=e[d][1],i=e[d][2];for(var a=!0,l=0;l<n.length;l++)(!1&i||c>=i)&&Object.keys(s.O).every(function(e){return s.O[e](n[l])})?n.splice(l--,1):(a=!1,i<c&&(c=i));if(a){e.splice(d--,1);var r=o();void 0!==r&&(t=r)}}return t}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[n,o,i]}}(),function(){s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,{a:t}),t}}(),function(){s.d=function(e,t){for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){s.p=""}(),function(){var e={524:0};s.O.j=function(t){return 0===e[t]};var t=function(t,n){var o,i,c=n[0],a=n[1],l=n[2],r=0;if(c.some(function(t){return 0!==e[t]})){for(o in a)s.o(a,o)&&(s.m[o]=a[o]);if(l)var d=l(s)}for(t&&t(n);r<c.length;r++)i=c[r],s.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return s.O(d)},n=self["webpackChunkwidget"]=self["webpackChunkwidget"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=s.O(void 0,[504],function(){return s(9817)});n=s.O(n)})();